# «Резервное копирование баз данных» | "Бойко Владислав"
---
## Задание 1
Условлюсь на том что наши хотелки ничем не ограничены
### 1.1
В данном случае стоит воспользоваться следующей схемой:
Раз в неделю делаем full backup, а затем в конце каждого дня делаем деференцированный backup. Таким образом мы соблюдем баланс между объемом самих бекапов и скоростью их создания при сохранении достаточно высокой скорости развертывания бекапа. Можно так же заменить диференцированный бекап инкрементным, что облегчит сам бекап и увеличит скорость его создания, но увеличит время на развертывание бекапа, а так же уменьшет надежность ведь восстановить следующую инкрементную копию возможно только при целостности предыдущей(для финтеха такой вариант считаю неприемлемым и опастным)
### 1.2 
Воспользуемся предыдущим методом (Раз в неделю делаем full backup, а затем в конце каждого дня делаем деференцированный backup), но добавим туда почасовое инкрементное резервирование. Таким образом мы получим желаемое, но опять же надежность хворает. Поэтому думаю лучше изанально использовать Postgresql ведь он имеет прекрастный журнал предзаписи, в итоге мы используем схему (Раз в неделю делаем full backup, а затем в конце каждого дня делаем деференцированный backup), а с помощью журнала можем добраться до необходимой временной точки.
### 1.3 
Разумеется да, изученная ранее репликация master-slave позволяет в случае выхода из строя мастера(или мастеров) оперативно назначить нового мастера из списка слейвов. В таком случае база продолжит работу, а пользователь может этого даже и не почувствовать
---
## Задание 2
### 2.1
pg_dump [параметр-подключения...] [параметр...] [имя_бд];
pg_restore [параметр-подключения...] [параметр...] [имя_файла];
Пример простейшей команды: pg_dump my_bd_netology > /home/vlad/02.09.23_dump.sql - она выполнит обычный дамп БД "my_bd_netology" и сохранит в файл "/home/vlad/02.09.23_dump", далее извращаясь можно запустить дамп в несколько потоков, в разный конечный формат, в т.ч. дампить только фалы или только схемы, включать в дамп команды create и drop что позволит при запуске создавать или удалять и созавать БД и уже далее наполнять ее нашим бекапом. Можно так же выгружать таблици\схемы по определенным заданным шаблонам и далее и тому подобное.
Пример простейшей команды: pg_restore -d my_bd_netology /home/vlad/02.09.23_dump.sql, тут мы берем созданный ранее дамп и восстанавливаем ее в нашу БД 
### 2.2 
Автоматизировать? Да можно, для этого и существуют как минимум скрипты и шедулеры в которых пожно прописать когда, что и с какой периодичностью делать
---
## Задание 3
### 3.1
Инкрементный бекап в mysql возможен при включенном бинарном журнале(он и реализует бекапы), далее  
1. делаем full: [mysqldump -uroot -p --all-databases --single-transaction --flush-logs --master-data=2 > full_backup.sql]
2. создаем инкриментную копию [mysqladmin -uroot -p flush-logs]; (команда --flush-logs что в первом что во втором случае закрывает текущий бинарный журнал и открывает новый)
3. Далее мы восстановим full: [mysql -u root -p mydb < full_backup.sql]
4. Далее используя сохраненный журна восстановим инкриментную копию [mysqlbinlog /var/log/mysql/mysql-bin.000002 | mysql -uroot -p mydb]; (журнал с порядковым номером 000001 привязан к full, а с номером 000002 к нашему инкрименту)
5. Конгратюляции вы великолепны
### 3.2
В случае с большими и объемными базами наличие реплики будит приемуществом т.к. скорость поднятия бекапа в разы ниже чем скорость смены мастер ноды, и чем больше объем БД тем больше разница между данными методами
---